# 📊 SQL_Insights.Gemini.Activities

**SQL_Insights.Gemini.Activities** is a custom UiPath activity that connects to a SQL Server database and generates AI-powered insights using **Google Gemini API**.

---

## 🚀 Overview

This activity allows developers to:
- Connect to a **SQL Server database** securely using a `SecureString` connection string.
- Use the **Gemini API** to:
  - Automatically analyze the database schema.
  - Generate a **SELECT SQL query** based on a user prompt.
  - Run the generated query.
  - Analyze the results using Gemini for summarization or insights.

---

## ✅ Features

- 🔐 Supports **SecureString** inputs for both the **connection string** and **Gemini API key**.
- 📦 Converts `SecureString` safely in memory.
- 📄 Extracts schema from SQL using `INFORMATION_SCHEMA.COLUMNS`.
- 🧠 Uses Gemini API to generate and analyze queries.
- 🗃 Returns summarized AI insight from your SQL data.

---

## 📥 Inputs

| Name             | Type                        | Description                                                                 |
|------------------|-----------------------------|-----------------------------------------------------------------------------|
| ConnectionString | SecureString                | Secure connection string for SQL Server. Required for schema + data access.|
| GeminiApiKey     | SecureString                | Secure Gemini API key (used in Authorization header).                       |
| GeminiModel      | String                      | Gemini model to use (e.g., `gemini-pro`).                                   |
| UserPrompt       | String                      | Prompt describing the insight/question you want to ask about the data.      |

---

## 📤 Output

| Name     | Type   | Description                                     |
|----------|--------|-------------------------------------------------|
| Response | String | The summarized response generated by Gemini.   |

---

## ⚙️ Requirements

- 📂 UiPath Studio 2022.10+
- 💠 .NET 6 Custom Activity Template
- 🔐 SecureString handling requires **Orchestrator Credential Assets** or `Get Secure Asset` logic
- 💾 `sni.dll` is required for `System.Data.SqlClient` to function correctly

---

## ⚠️ Manual Step Required

To avoid runtime errors like `Unable to load DLL 'sni.dll'`, you must:

1. Copy the following file manually after installing the package:
   
   [SNI.dll](https://github.com/AmrEzzatAbdo/SQL_Insights.Gemini.Activities/blob/main/sni.dll)
   

2. Paste it into this folder:
   ```
   C:\Users\<YOUR_USERNAME>\AppData\Local\Programs\UiPath\Studio
   ```

> 📝 This is due to native dependency limitations when packaging SQL client libraries inside a NuGet package.

---

## 🧠 Use Cases

- Generate custom SQL SELECT queries without writing them manually.
- Summarize data responses in natural language.
- Provide self-service BI for users without direct DB access.

---

## 📜 License

This project is licensed under the **MIT License**.

---

## 👨‍💻 Author

Developed by **Amr Ezzat**

- LinkedIn: [linkedin.com/in/amr-ezzat](https://www.linkedin.com/in/amrezzatabdal-al/)
- Email: `amrezzat289@gmail.com`

---

> Contributions, issues, and suggestions are welcome!
